# Сценарии работы

### У нас есть 3 сценарии создания и работы над заданием:

1. Создание задачи типа NOTIFICATION
```http
[POST] http://localhost:8080/tasks
```
```json
{
	"creationDate": "2024-08-05T09:50:50.7572",
	"targetDate": "2024-08-10T18:00:00",
	"type": "NOTIFICATION",
	"isParallel": true,
	"title": "Приоритетная задача",
	"body": "Завершить проект до срока.",
	"authorID": 1,
	"responsibles": [2, 3]
}
```
- Получаем данные
- Проверяем на корректность
- Создается уведомление
- Назначенным сотрудником отправляется уведомление о том, что поступила задача
- Так как задача является NOTIFICATION, задача закрывается сразу после отправки уведомление

2. Создание задачи типа COMMENT
```http
[POST] http://localhost:8080/tasks
```
```json
{
	"creationDate": "2024-08-05T09:50:50.7572",
	"targetDate": "2024-08-10T18:00:00",
	"type": "COMMENT",
	"isParallel": true,
	"title": "Приоритетная задача",
	"body": "Завершить проект до срока.",
	"authorID": 1,
	"responsibles": [2, 3]
}
```
- Получаем данные
- Проверяем на корректность
- Создается уведомление
- Назначенным сотрудником отправляется уведомление о том, что поступила задача
- Сотрудник видит уведомление
- Переходит по ссылке
```http
[POST] http://localhost:8080/tasks/{taskId}
```
- нажимает на кнопку прокомментировать
```http
[POST] http://localhost:8080/tasks/{taskId}/comments
```
```json
{
	"authorID": "3",
	"creationDate": "2024-08-05T09:50:50.7572",
	"text": "Текст комментария"
}
```
- Отправляет свой комментарий
- Проверяем, есть ли права у отправляющего на выполнение этой задачи, если все окей то коммент отправляется дальше
- Если в пункте '_isParallel_' указано значение '_false_', то задача автоматический закрывается
- Если в пункте '_isParallel_' указано значение '_true_', то задача закрывается после того, как остальные назначенные сотрудники прокомментируют задачу.
- Задача закрывается
- Руководителю приходит уведомление о том, что все назначенные люди прокомментировали задачу
- Сотрудником приходит уведомление о том, что задача закрыта

3. Создание задачи типа ASSIGNMENT
```http
[POST] http://localhost:8080/tasks
```
```json
{
	"creationDate": "2024-08-05T09:50:50.7572",
	"targetDate": "2024-08-10T18:00:00",
	"type": "ASSIGNMENT",
	"isParallel": true,
	"title": "Приоритетная задача",
	"body": "Завершить проект до срока.",
	"authorID": 1,
	"responsibles": [2]
}
```
- Получаем данные
- Проверяем на корректность
- Создается уведомление
- Задача может быть назначена только одному сотруднику, если было указано несколько, то происходит исключение уведомляющая о том, что это действие невозможны и просит повторить действие
- Сотрудник видит уведомление
- Переходит по ссылке
- Для выполнение задачи типа ASSIGNMENT, сотрудник обязательно должен принять задачу
```http
[POST] http://localhost:8080/tasks/{taskId}/start
```
- Статус задачи меняется на `*IN_PROGRESS*`
- Руководителю приходить уведомление, где сказано, что сотрудник принял задачу, и в процессе выполнения
- Сотрудник выполняет задачу
- Выполненную задачу отправляет для проверки
```http
[POST] http://localhost:8080/tasks/{taskId}/decision
```
```JSON
{
	"authorID":"2",
	"creationDate":"2024-08-05T09:50:50.7572",
	"text":"hjkdexn"
}
```
- Проверяем, есть ли права у отправляющего на выполнение этой задачи, если все окей то решение отправляется дальше
- Решение принимает статус `*SUBMITTED*`
- Руководителю приходит уведомление о том, что сотрудник выполнил задачу и ждет проверку
- Руководитель проверяет задачу и отправляет ответ
```http
[POST] http://localhost:8080/tasks/{taskId}/status
```
```JSON
{
	"status":"APPROVED"
}
```
- Если ответ APPROVED, задача завершается
- Если ответ FAILED, задача отправляется на доработку
- Статус решения задачи устанавливается в соответствии с ответом.
- Отправляется соответствующее уведомление.
- Процесс будет продолжаться до тех пор, пока решение не получит ответ APPROVED

___

- Просмотр всех задач
```http
[GET] http://localhost:8080/tasks
```
- Получение задачи по ID
```http
[GET] http://localhost:8080/tasks/{taskId}
```
- Продление дедлайна
```http
[PUT] http://localhost:8080/tasks/{taskId}
```
```json
{ 
	"targetDate": "2024-07-20T18:00:00.000+00:00"
}
```
- Удаление задачи
```http
[DELETE] http://localhost:8080/tasks/{taskId}
```
- Завершение задачи
```http
[PUT] http://localhost:8080/tasks/{taskId}/completed
```
- Список задач автора
```http
[GET] http://localhost:8080/tasks/createdBy/{authorId}
```
- Список задач пользователя
```http
[GET] http://localhost:8080/tasks/assignedTo/{userId}
```
- Получить все уведомления
```http
[GET] http://localhost:8080/notifications/{userId}
```
- Пометить уведомление как прочитанное
```http
[GET] http://localhost:8080/notifications/{userId}/read
```
- Пометить все уведомления как прочитанные
```http
[GET] http://localhost:8080/notifications/{userId}/readAll
```